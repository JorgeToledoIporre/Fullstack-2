<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Lato&family=Pacifico&display=swap" rel="stylesheet">
</head>
<body>

<header>
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">
        <img src="images/logo.jpg" alt="logo" width="30" height="24"> PMS©
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
        aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link text-white" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="productos.html">Productos</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="nosotros.html">Nosotros</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="blogs.html">Blogs</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="contacto.html">Contacto</a></li>
        </ul>
      </div>
      <a href="carrito.html" class="navbar-text text-white fw-bold d-flex align-items-center text-decoration-none">
        <img src="images/utiles/carrito.png" alt="Carrito" style="width: 20px; height: 20px; margin-right: 8px;">
        Carrito (<span id="cart-count">0</span>)
      </a>
    </div>
  </nav>
</header>

<!-- Logo y nombre de la empresa -->
<div>
    <img src="images/LogoEmpresa.jpg" class="img-fluid rounded mx-auto d-block" alt="LogoEmpresa">
    <header class="container text-center">
        <h1>Pastelería Mil Sabores</h1>
    </header>
</div>

<section class="container my-5">
  <div class="text-center mb-3"><h2>Iniciar Sesión</h2></div>

  <!-- Inicio de sesión-->
  <div class="container">
    <form id="loginForm" class="row mt-3 g-3 needs-validation" novalidate>
        <div class="col-6 position-relative">
            <label for="emailId" class="form-label">Correo
              <span class="guiaValidacion">(?)
                <span class="guiaValidacion-texto">
                  Debe terminar en:<br>
                  • @duoc.cl<br>
                  • @profesor.duoc.cl<br>
                  • @gmail.com
                </span>
              </span>
            </label>
            <input type="email" class="form-control" id="emailId" required maxlength="100" placeholder="ejemplo@duoc.cl" pattern="^[a-zA-Z0-9._%+-]+@(duoc\.cl|profesor\.duoc\.cl|gmail\.com)$">
            <div class="invalid-feedback">El correo no es válido.</div>
        </div>

        <div class="col-6 position-relative">
            <label for="contraseñaId" class="form-label">Contraseña
              <span class="guiaValidacion">(?)
                <span class="guiaValidacion-texto">
                  Debe tener entre 4-10 caracteres
                </span>
              </span>
            </label>
            <input type="password" class="form-control" id="contraseñaId" required minlength="4" maxlength="10" placeholder="**********">
            <div class="invalid-feedback">La contraseña no es válida</div>
        </div>

        <div class="col-12 text-center mt-3">
          <button type="submit" class="btn btn-primary">Enviar</button>
        </div>
    </form>
  </div>
</section>

<footer class="footer">
  <div class="footer-info">
    <p>© 2025, Pastelería Mil Sabores. Todos los derechos reservados...</p>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.getElementById("loginForm").addEventListener("submit", function(e) {
    e.preventDefault(); // evita envío normal

    const form = this;
    const email = document.getElementById("emailId");
    const password = document.getElementById("contraseñaId");

    // Resetear validación
    email.classList.remove('is-invalid');
    password.classList.remove('is-invalid');

    // Verificación de campos requeridos
    if (!form.checkValidity()) {
        form.classList.add('was-validated');
        return;
    }

    // Validación de login
    if (email.value.trim() === "admin@gmail.com" && password.value.trim() === "admin") {
        window.location.href = "homeAdmin.html";
    } else {
        // Mostrar invalid-feedback de ambos campos
        email.classList.add('is-invalid');
        password.classList.add('is-invalid');
    }
});
</script>

<script>
    // Función para obtener el carrito actual desde localStorage
  function obtenerCarrito() {
    const carrito = localStorage.getItem('carrito');
    return carrito ? JSON.parse(carrito) : [];
  }

  // Función para actualizar el contador del carrito
  function actualizarContadorCarrito() {
    const carrito = obtenerCarrito();
    const totalItems = carrito.reduce((total, producto) => total + producto.cantidad, 0);
    document.getElementById('cart-count').textContent = totalItems;
  }

  // Ejecutar al cargar la página
  document.addEventListener('DOMContentLoaded', function() {
    actualizarContadorCarrito();
  });
</script>

</body>
</html>
